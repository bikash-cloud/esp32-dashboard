<!DOCTYPE html>
<html>
<head>
<title>ESP32 AI Dashboard</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<style>
body {
  background:#0b0b0b;
  color:white;
  font-family:Arial;
  text-align:center;
}
.card {
  background:#111;
  padding:20px;
  border-radius:10px;
  width:400px;
  margin:auto;
  box-shadow:0 0 20px cyan;
}
.bar {
  width:100%;
  background:#333;
  border-radius:10px;
  overflow:hidden;
}
.fill {
  height:20px;
  width:0%;
  background:lime;
}
.log {
  margin-top:10px;
  height:150px;
  overflow:auto;
  text-align:left;
  font-size:14px;
}
</style>
</head>
<body>

<h1>ðŸš€ ESP32 AI Detection Dashboard</h1>

<div class="card">
  <h2 id="label">Label: Waiting...</h2>
  <div class="bar"><div id="bar" class="fill"></div></div>
  <h3 id="confidence">Confidence: 0%</h3>
  <div class="log" id="log"></div>
</div>

<script>
const broker = "wss://7621af003a1046a0b6392f03aab1a6d3.s1.eu.hivemq.cloud:8884/mqtt";   // ðŸ”´ CHANGE
const username = "Bikash";                  // ðŸ”´ CHANGE
const password = "Bikash8917";                  // ðŸ”´ CHANGE
const topic = "esp32/detection";

const client = mqtt.connect(broker, {username, password});

client.on("connect", () => {
  console.log("Connected");
  client.subscribe(topic);
});

client.on("message", (topic, msg) => {
  const data = JSON.parse(msg.toString());
  let label = data.label;
  let conf = (data.confidence * 100).toFixed(2);

  document.getElementById("label").innerHTML = "Label: " + label;
  document.getElementById("confidence").innerHTML = "Confidence: " + conf + "%";
  document.getElementById("bar").style.width = conf + "%";

  let log = document.getElementById("log");
  log.innerHTML = `<div>[${new Date().toLocaleTimeString()}] ${label} (${conf}%)</div>` + log.innerHTML;
});
</script>

</body>
</html>
